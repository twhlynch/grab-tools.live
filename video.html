<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video to Grab | GRAB Tools</title>
    <meta name="description" content="A collection of tools for modding GrabVR, stats about players and levels, resources, and more.">
    <meta name="keywords" content="grab mods stats tools grabvr .index index dotindex tom lynch twhlynch vr modding hacks discord programming coding website development developer github">
    <meta name="author" content="twhlynch">
    <meta property="og:title" content="Video Gen | GRAB Tools">
    <meta property="og:description" content="A collection of tools for modding GrabVR, stats about players and levels, resources, and more.">
    <meta property="og:site_name" content="Video Gen | GRAB Tools">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://grab-tools.live/video">
    <meta property="og:image" content="http://grab-tools.live/favicon.gif">
    <link rel="icon" href="favicon.gif" type="image/gif">
    <link rel="shortcut icon" href="favicon.gif" type="image/x-icon">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BDS57RBQ3Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-BDS57RBQ3Q');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2378042345376266" crossorigin="anonymous"></script>
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
    <link rel="stylesheet" href="styles/style.css">
    <script src="main.js" defer></script>
    <script>
        async function processVideo() {
            const fileInput = document.getElementById("videoFile");
            const videoFile = fileInput.files[0];

            const formData = new FormData();
            formData.append("file", videoFile);

            document.getElementById("videoButton").style.display = "none";
            document.getElementById("error").innerText = "Loading...";

            try {
                const response = await fetch(
                    "https://dotindex.pythonanywhere.com/process_video",
                    {
                        method: "POST",
                        body: formData,
                    }
                );

                if (!response.ok) {
                    document.getElementById("error").innerText = await response.text();
                    throw new Error("Error processing video");
                }

                const processedFile = await response.blob();
                const downloadLink = URL.createObjectURL(processedFile);

                const link = document.createElement("a");
                link.href = downloadLink;
                link.download = `${Math.floor(Date.now() / 1000)}.level`;
                link.click();
                document.getElementById("error").innerText = "Success";


                URL.revokeObjectURL(downloadLink);
            } catch (error) {
                console.error(error);
            }
            document.getElementById("videoButton").style.display = "flex";
        }
    </script>
</head>
<body>
    <div id="cursor-outer"></div>
    <div id="cursor-inner"></div>
    <!-- <h1 class="title">Grab</h1> -->
    <nav>
        <a href="/" class="button">Home</a>
        <a href="/stats" class="button">Stats</a>
        <a href="/tools" class="button">Tools</a>
        <a href="/discord" class="button">Discord</a>
        <a href="https://wiki.grab-tools.live" class="button">Wiki</a>
        <button id="darkMode">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
            </svg>
        </button>
    </nav>
    <main>
        <section id="video-section">
            <h1>Video Generator (Mp42Grab)</h1>
            <p>15 second max length. Output will always be 20x20. This is a demo. The full script can be found <a href="https://github.com/twhlynch/Mp42Grab">here</a> to download.</p>
            <div id="video-buttons">
                <input type="file" id="videoFile" />
                <button class="button" id="videoButton" onclick="processVideo()">Process Video</button>
            </div>
            <p id="error"></p>
        </section>
    </main>
    <footer>
        <span>twhlynch</span><span>|</span><span>.index</span>
        <div id="ads"></div>
    </footer>
</body>
</html>
